---
import { type CollectionEntry, getCollection } from 'astro:content';
import Main from '@/layouts/Main.astro';
import FormattedDate from '@/components/FormattedDate.astro';
import ShareButtons from '@/components/ShareButtons.astro';
import { render } from 'astro:content';
import { url } from '@/utils/url';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.id },
		props: post,
	}));
}
type Props = CollectionEntry<'blog'>;

const post = Astro.props;
const { Content } = await render(post);
const { title, description, pubDate, updatedDate, heroImage } = post.data;
const postUrl = `/blog/${post.id}/`;
---

<Main title={title} description={description} image={heroImage}>
  <article class="py-5 card">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-10">

          {heroImage && (
            <div class="mb-4">
              <img
                src={url(heroImage)}
                alt={title}
                class="img-fluid rounded shadow-sm"
                width={1020}
                height={510}
              />
            </div>
          )}

          <div class="mb-4">
            <p class="text-muted mb-1">
              Publicado el <FormattedDate date={pubDate} />
              {updatedDate && (
                <>
                  {' Â· '}
                  <span class="text-muted">Actualizado el <FormattedDate date={updatedDate} /></span>
                </>
              )}
            </p>
            <h1 class="display-5 fw-bold">{title}</h1>
            <hr />
          </div>

          <div class="prose">
            <Content />
          </div>

          <ShareButtons title={title} url={postUrl} description={description} />

        </div>
      </div>
    </div>
  </article>
</Main>
